.ORIG x800
LD R0, VEC
LD R1, ISR
STR R1, R0, #0
LDI R0, KBSR
LD R1, MASK
NOT R1, R1
AND R0, R0, R1
NOT R1, R1
ADD R0, R0, R1
STI R0, KBSR
LD R0, PSR
ADD R6, R6, #-1
STR R0, R6, #0
LD R0, PC
ADD R6, R6, #-1
STR R0, R6, #0
RTI
VEC .FILL x0180
ISR .FILL x1000
KBSR .FILL xFE00
MASK .FILL x4000
PSR .FILL x8002
PC .FILL x3000
AND R0, R0, #0
LD R0, TIME
DELAY ADD R0, R0, #-1
BRP DELAY
TIME .FILL #10000
STUID .STRINGZ "PB123 "
FACT_N .FILL xFFFF
LD R0, Factorial0
LD R5, N_ADDR
STR R0, R5, #0
ADD R5, R0, #0
LD R3, ZERO
ADD R0, R0, R3 
ADD R4, R0, #0
BRN WRONG
LD R3, NINE
ADD R0, R5, R3 
BRP WRONG
LD R0, NEWLINE
BRNZP RIGHT
WRONG ADD R0, R0, R0
LD R0, NEWLINE
RTI 
RIGHT LD R3, ZERO
ADD R2, R5, R3
ADD R1, R2, #-8
BRZP TOOLARGE
ADD R0, R5, #0
ADD R1, R2, R1
LDR R0, R1, #0
TOOLARGE ADD R0, R5, #0
TRAP x25
N_ADDR .FILL x3FFF
ZERO .FILL xFFD0
NINE .FILL xFFC7 
NEWLINE .FILL x000A
ADDR0 .FILL #1
ADDR1 .FILL #1
ADDR2 .FILL #1
ADDR3 .FILL #1
ADDR4 .FILL #1
ADDR5 .FILL #1
ADDR6 .FILL #1
ADDR7 .FILL #1
OUTPUT1 .STRINGZ " is not a decimal digit. "
OUTPUT2 .STRINGZ " is a decimal digit. "
OUTPUT3 .STRINGZ "! = "
OUTPUT5 .STRINGZ "! is too large for LC-3."
Factorial0 .STRINGZ "1."
Factorial1 .STRINGZ "1."
Factorial2 .STRINGZ "2."
Factorial3 .STRINGZ "6."
Factorial4 .STRINGZ "24."
Factorial5 .STRINGZ "120."
Factorial6 .STRINGZ "720."
Factorial7 .STRINGZ "5040."
.END